import store from"../../../lib/store/index.js";import Navigo from"../../../lib/router/es/index.js";import AppHeader from"../../appheader/src/AppHeader.js";import AppFooter from"../../appfooter/src/AppFooter.js";class AudiophileApp extends HTMLElement{constructor(){super();this.attachShadow({mode:"open"})}connectedCallback(){this.storeInit();this.render();this.routerInit()}render(){this.HTML();this.CSS();this.SCRIPTS()}HTML(){this.shadowRoot.innerHTML=`<app-header backgroundColor="on"></app-header>\n            <output id="routerOutput">\n            </output>\n            <app-footer></app-footer>`}CSS(){this.shadowRoot.innerHTML+=`<style>\n                :host {\n                    background-color: var(--white-1);\n                    display: block;\n                    min-height: 100%;\n                }\n            </style>`}routerInit(){this.routerOutput=this.shadowRoot.querySelector("#routerOutput");this.router=new Navigo("/",{hash:true});this.router.on("/",(async()=>{await import("../../homesection/src/HomeSection.js");this.routerOutput.innerHTML=`<home-section></home-section>`;this.scrollToTop();this.closeShoppingCart()}));this.router.on("headphones",(async()=>{await import("../../productcategory/src/ProductCategory.js");this.routerOutput.innerHTML=`<product-category category="headphones"></product-category>`;this.scrollToTop();this.closeShoppingCart()}));this.router.on("speakers",(async()=>{await import("../../productcategory/src/ProductCategory.js");this.routerOutput.innerHTML=`<product-category category="speakers"></product-category>`;this.scrollToTop();this.closeShoppingCart()}));this.router.on("earphones",(async()=>{await import("../../productcategory/src/ProductCategory.js");this.routerOutput.innerHTML=`<product-category category="earphones"></product-category>`;this.scrollToTop();this.closeShoppingCart()}));this.router.on("headphones/:product",(async({data:t})=>{await import("../../productdetail/src/ProductDetail.js");this.routerOutput.innerHTML=`<product-detail product="${t.product}"></product-detail>`;this.scrollToTop();this.closeShoppingCart()}));this.router.on("speakers/:product",(async({data:t})=>{await import("../../productdetail/src/ProductDetail.js");this.routerOutput.innerHTML=`<product-detail product="${t.product}"></product-detail>`;this.scrollToTop();this.closeShoppingCart()}));this.router.on("earphones/:product",(async({data:t})=>{await import("../../productdetail/src/ProductDetail.js");this.routerOutput.innerHTML=`<product-detail product="${t.product}"></product-detail>`;this.scrollToTop();this.closeShoppingCart()}));this.router.on("checkout",(async()=>{await import("../../checkoutdetails/src/CheckoutDetails.js");this.routerOutput.innerHTML=`<checkout-details></checkout-details>`;this.scrollToTop();this.closeShoppingCart()}));this.router.resolve()}storeInit(){this.store=store;this.store.observer.subscribe("stateChange",(()=>this.pathMap(this)));this.store.dispatch("productDataAPIFetch","n/a")}pathMap(t){const e=t.store.state.path;const o={title:document.title,historyAPIMethod:"replaceState",updateBrowserURL:true,updateState:true,force:false};switch(e){case"/":t.router.navigate("/",o);break;case"checkout":t.router.navigate("checkout",o);break}const r=new RegExp(`/headphones`);const s=new RegExp(`/speakers`);const a=new RegExp(`/earphones`);if(r.test(e)){const s=e.replace(r,"");switch(e){case"/headphones":t.router.navigate("/headphones",o);break;case`/headphones${s}`:t.router.navigate(`/headphones${s}`,o);break}}if(s.test(e)){const r=e.replace(s,"");switch(e){case"/speakers":t.router.navigate("/speakers",o);break;case`/speakers${r}`:t.router.navigate(`/speakers${r}`,o);break}}if(a.test(e)){const r=e.replace(a,"");switch(e){case"/earphones":t.router.navigate("/earphones",o);break;case`/earphones${r}`:t.router.navigate(`/earphones${r}`,o);break}}}scrollToTop(){document.querySelector("body").scrollIntoView({behavior:"smooth"})}closeShoppingCart(){const t=this.shadowRoot.querySelector("app-header").shadowRoot.querySelector("#shoppingCartOverlay");if(t.classList.contains("visible")){t.classList.remove("visible")}}SCRIPTS(){this.linksManager()}linksManager(){this.shadowRoot.addEventListener("click",(t=>{t.preventDefault();const e=t.composedPath()[0].getAttribute("data-path");e?this.store.dispatch("navigate",e):"";if(t.composedPath()[0].className===`linkContainer`){this.store.dispatch("navigate",`/${t.composedPath()[0].getAttribute("href")}`)}}))}}if(!window.customElements.get("audiophile-app")){window.customElements.define("audiophile-app",AudiophileApp)}