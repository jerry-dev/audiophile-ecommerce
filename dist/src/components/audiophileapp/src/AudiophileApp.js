import store from"../../../lib/store/index.js";import Navigo from"../../../lib/router/es/index.js";import AppHeader from"../../appheader/src/AppHeader.js";import AppFooter from"../../appfooter/src/AppFooter.js";class AudiophileApp extends HTMLElement{constructor(){super();this.attachShadow({mode:"open"})}connectedCallback(){this.render();this.routerInit();this.storeInit()}render(){this.HTML();this.CSS();this.SCRIPTS()}HTML(){this.shadowRoot.innerHTML=`<app-header backgroundColor="on"></app-header>\n            <output id="routerOutput">\n            </output>\n            <app-footer></app-footer>`}CSS(){this.shadowRoot.innerHTML+=`<style>\n                :host {\n                    background-color: var(--white-1);\n                    display: block;\n                    min-height: 100%;\n                }\n            </style>`}routerInit(){this.routerOutput=this.shadowRoot.querySelector("#routerOutput");this.router=new Navigo("/");this.router.on("/",(async()=>{await import("../../homesection/src/HomeSection.js");this.routerOutput.innerHTML=`<home-section></home-section>`;this.scrollToTop();this.closeShoppingCart();this.unlockScrolling()}));this.router.on("/headphones",(async()=>{await import("../../productcategory/src/ProductCategory.js");this.routerOutput.innerHTML=`<product-category category="headphones"></product-category>`;this.scrollToTop();this.closeShoppingCart();this.unlockScrolling()}));this.router.on("/speakers",(async()=>{await import("../../productcategory/src/ProductCategory.js");this.routerOutput.innerHTML=`<product-category category="speakers"></product-category>`;this.scrollToTop();this.closeShoppingCart();this.unlockScrolling()}));this.router.on("/earphones",(async()=>{await import("../../productcategory/src/ProductCategory.js");this.routerOutput.innerHTML=`<product-category category="earphones"></product-category>`;this.scrollToTop();this.closeShoppingCart();this.unlockScrolling()}));this.router.on("/headphones/:product",(async({data:t})=>{await import("../../productdetail/src/ProductDetail.js");this.routerOutput.innerHTML=`<product-detail product="${t.product}"></product-detail>`;this.scrollToTop();this.closeShoppingCart();this.unlockScrolling()}));this.router.on("/speakers/:product",(async({data:t})=>{await import("../../productdetail/src/ProductDetail.js");this.routerOutput.innerHTML=`<product-detail product="${t.product}"></product-detail>`;this.scrollToTop();this.closeShoppingCart();this.unlockScrolling()}));this.router.on("/earphones/:product",(async({data:t})=>{await import("../../productdetail/src/ProductDetail.js");this.routerOutput.innerHTML=`<product-detail product="${t.product}"></product-detail>`;this.scrollToTop();this.closeShoppingCart();this.unlockScrolling()}));this.router.on("/checkout",(async()=>{await import("../../checkoutdetails/src/CheckoutDetails.js");this.routerOutput.innerHTML=`<checkout-details></checkout-details>`;this.scrollToTop();this.closeShoppingCart();this.unlockScrolling()}));this.router.resolve()}storeInit(){this.store=store;this.store.observer.subscribe("stateChange",(()=>this.pathMap(this)));this.store.dispatch("productDataAPIFetch","n/a")}pathMap(t){const e=t.store.state.path;switch(e){case"/":t.router.navigate("/",{historyAPIMethod:"replaceState"});break;case"checkout":t.router.navigate("/checkout",{historyAPIMethod:"replaceState"});break}const o=new RegExp(`/headphones`);const r=new RegExp(`/speakers`);const s=new RegExp(`/earphones`);if(o.test(e)){const r=e.replace(o,"");switch(e){case"/headphones":t.router.navigate("/headphones",{historyAPIMethod:"replaceState"});break;case`/headphones${r}`:t.router.navigate(`/headphones${r}`,{historyAPIMethod:"replaceState"});break}}if(r.test(e)){const o=e.replace(r,"");switch(e){case"/speakers":t.router.navigate("/speakers",{historyAPIMethod:"replaceState"});break;case`/speakers${o}`:t.router.navigate(`/speakers${o}`,{historyAPIMethod:"replaceState"});break}}if(s.test(e)){const o=e.replace(s,"");switch(e){case"/earphones":t.router.navigate("/earphones",{historyAPIMethod:"replaceState"});break;case`/earphones${o}`:t.router.navigate(`/earphones${o}`,{historyAPIMethod:"replaceState"});break}}}scrollToTop(){this.shadowRoot.querySelector("app-header").scrollIntoView({behavior:"smooth"})}closeShoppingCart(){const t=this.shadowRoot.querySelector("app-header").shadowRoot.querySelector("#shoppingCartOverlay");if(t.classList.contains("visible")){t.classList.remove("visible")}}SCRIPTS(){this.linksManager()}linksManager(){this.shadowRoot.addEventListener("click",(t=>{t.preventDefault();const e=t.composedPath()[0].getAttribute("data-path");e?this.store.dispatch("navigate",e):"";if(t.composedPath()[0].className===`linkContainer`){this.store.dispatch("navigate",`/${t.composedPath()[0].getAttribute("href")}`)}}))}unlockScrolling(){if(document.querySelector("body").classList.contains("locked")){document.querySelector("body").classList.remove("locked")}}}if(!window.customElements.get("audiophile-app")){window.customElements.define("audiophile-app",AudiophileApp)}